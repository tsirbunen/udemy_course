name: Events Demo 1
# Jokainen push aiheuttaisi näissä tämän workflown
# on: push
# on: [push]

# Kun halutaan vain, kun pull_request tietyissä tapauksissa
on: 
  # Triggeröityy, kun tulee pull_request
  pull_request:
    # Jonka activity type on opened
    types:
    - opened
    # Ja jolle voidaan vielä määrittää event filter
    branches:
    - main

  # Jos halutaan myös mahdollisuus käynnistää manuaalisesti.
  # Huomaa, että tässä pitää laittaa loppuun ":", vaikka ei
  # määritetäkään tyyppejä
  workflow_dispatch:

  push:
    branches:
      - main
      # Mikä vain branch, jonka nimi alkaa dev-
      - 'dev-*'
      # Mikä vain branch, jonka nimi alkaa feature/
      - 'feature/*'
      # Mikä vain branch, jonka nimi alkaa bug/
      # ja jossa saa olla lisää "/"-merkkejä
      - 'bug/**'
    # Filtteröidään tiedostojen perusteella
    paths-ignore:
      # Aja, kun ei tapahdu muutosta tiedostossa 
      # VAIKKA tapahtuisi muutos jossain toisessa tiedostossa 
      - '.github/workflows/*'
    # Aja, kun muuttuu joku ts-tiedosto
    paths:
      - '**.ts'


jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Output event data
        run: echo "${{ toJSON(github.event) }}"
      - name: Get code
        uses: actions/checkout@v3
      - name: Install dependencies
        run: npm ci
      - name: Test code
        run: npm run test
      - name: Build code
        run: npm run build
      - name: Deploy project
        run: echo "Deploying..."